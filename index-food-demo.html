<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>7 Pleasures - Food Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
    const { useState, useEffect, createElement: h } = React;
    
    const cuisines = [
      { name: 'Italian', emoji: 'ðŸ•' }, { name: 'Asian', emoji: 'ðŸœ' },
      { name: 'Mexican', emoji: 'ðŸŒ®' }, { name: 'American', emoji: 'ðŸ”' },
      { name: 'French', emoji: 'ðŸ¥–' }, { name: 'Indian', emoji: 'ðŸ›' },
      { name: 'Mediterranean', emoji: 'ðŸ¥—' }, { name: 'Japanese', emoji: 'ðŸ±' },
      { name: 'Chinese', emoji: 'ðŸ¥¡' }, { name: 'Thai', emoji: 'ðŸ²' },
      { name: 'Greek', emoji: 'ðŸ¥™' }, { name: 'BBQ', emoji: 'ðŸ–' },
      { name: 'Seafood', emoji: 'ðŸ¦ž' }, { name: 'Vegetarian', emoji: 'ðŸ¥•' },
      { name: 'Dessert', emoji: 'ðŸ°' }, { name: 'Other', emoji: 'ðŸ½ï¸' }
    ];
    
    const mealTypes = [
      { name: 'Breakfast', emoji: 'ðŸ³' }, { name: 'Brunch', emoji: 'ðŸ¥ž' },
      { name: 'Lunch', emoji: 'ðŸ¥—' }, { name: 'Dinner', emoji: 'ðŸ' },
      { name: 'Snack', emoji: 'ðŸ¿' }, { name: 'Dessert', emoji: 'ðŸ°' }
    ];
    
    const cookingMethods = [
      { name: 'Homemade', emoji: 'ðŸ³' }, { name: 'Restaurant', emoji: 'ðŸª' },
      { name: 'Takeout', emoji: 'ðŸ¥¡' }, { name: 'Delivery', emoji: 'ðŸšš' }
    ];
    
    const allergens = [
      { id: 'dairy', name: 'Dairy', emoji: 'ðŸ¥›' },
      { id: 'gluten', name: 'Gluten', emoji: 'ðŸŒ¾' },
      { id: 'nuts', name: 'Nuts', emoji: 'ðŸ¥œ' },
      { id: 'shellfish', name: 'Shellfish', emoji: 'ðŸ¦' },
      { id: 'eggs', name: 'Eggs', emoji: 'ðŸ³' },
      { id: 'fish', name: 'Fish', emoji: 'ðŸŸ' },
      { id: 'soy', name: 'Soy', emoji: 'ðŸŒ±' },
      { id: 'spicy', name: 'Spicy', emoji: 'ðŸŒ¶ï¸' },
      { id: 'redmeat', name: 'Red Meat', emoji: 'ðŸ¥©' }
    ];
    
    function App() {
      const [currentUser, setCurrentUser] = useState('Demo User');
      const [entries, setEntries] = useState([]);
      const [showAddForm, setShowAddForm] = useState(false);
      const [newEntry, setNewEntry] = useState({
        date: new Date().toISOString().split('T')[0],
        dishName: '',
        mealType: '',
        cuisine: '',
        cookingMethod: '',
        restaurantName: '',
        myRating: 5,
        allergens: [],
        photo: null,
        notes: ''
      });
      
      useEffect(() => {
        const stored = localStorage.getItem('food_demo_entries');
        if (stored) setEntries(JSON.parse(stored));
      }, []);
      
      const saveEntries = (updated) => {
        localStorage.setItem('food_demo_entries', JSON.stringify(updated));
        setEntries(updated);
      };
      
      const handlePhotoUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => setNewEntry({...newEntry, photo: e.target.result});
          reader.readAsDataURL(file);
        }
      };
      
      const addEntry = () => {
        if (!newEntry.dishName || !newEntry.mealType) {
          alert('Please enter dish name and meal type');
          return;
        }
        const entry = {
          ...newEntry,
          user: currentUser,
          id: Date.now(),
          timestamp: new Date().toISOString()
        };
        saveEntries([entry, ...entries]);
        setNewEntry({
          date: new Date().toISOString().split('T')[0],
          dishName: '',
          mealType: '',
          cuisine: '',
          cookingMethod: '',
          restaurantName: '',
          myRating: 5,
          allergens: [],
          photo: null,
          notes: ''
        });
        setShowAddForm(false);
      };
      
      const deleteEntry = (id) => {
        if (confirm('Delete this entry?')) {
          saveEntries(entries.filter(e => e.id !== id));
        }
      };
      
      const stats = entries.length > 0 ? (() => {
        const thisYear = new Date().getFullYear();
        const yearEntries = entries.filter(e => new Date(e.date).getFullYear() === thisYear);
        const myEntries = yearEntries.filter(e => e.user === currentUser);
        const avgRating = myEntries.length > 0 ? (myEntries.reduce((sum, e) => sum + e.myRating, 0) / myEntries.length).toFixed(1) : 0;
        
        const cuisineCounts = {};
        myEntries.forEach(e => {
          if (e.cuisine) cuisineCounts[e.cuisine] = (cuisineCounts[e.cuisine] || 0) + 1;
        });
        const topCuisine = Object.entries(cuisineCounts).sort((a, b) => b[1] - a[1])[0];
        
        const homemadeCount = myEntries.filter(e => e.cookingMethod === 'Homemade').length;
        const homemadePercent = myEntries.length > 0 ? Math.round((homemadeCount / myEntries.length) * 100) : 0;
        
        const topRated = [...myEntries].sort((a, b) => b.myRating - a.myRating).slice(0, 3);
        
        return {
          total: yearEntries.length,
          myTotal: myEntries.length,
          avgRating,
          topCuisine: topCuisine ? topCuisine[0] : 'N/A',
          homemadePercent,
          topRated
        };
      })() : null;
      
      return h('div', { className: 'min-h-screen bg-gradient-to-br from-orange-900 via-yellow-900 to-black text-white pb-20' },
        h('div', { className: 'max-w-6xl mx-auto p-4' },
          h('div', { className: 'py-4 mb-4' },
            h('h1', { className: 'text-3xl font-bold' }, 'ðŸ½ï¸ Food Tracker Demo'),
            h('p', { className: 'text-sm text-orange-300' }, 'Track meals with allergens & photos'),
            h('p', { className: 'text-xs text-gray-400 mt-1' }, 'Tracking as: ' + currentUser)
          ),
          
          stats && h('div', { className: 'grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6' },
            h('div', { className: 'bg-orange-600/20 p-4 rounded-xl border border-orange-500/30' },
              h('h3', { className: 'text-xs font-semibold text-orange-300 mb-1' }, 'ðŸ“… Total Meals'),
              h('p', { className: 'text-2xl font-bold' }, stats.myTotal)
            ),
            h('div', { className: 'bg-yellow-600/20 p-4 rounded-xl border border-yellow-500/30' },
              h('h3', { className: 'text-xs font-semibold text-yellow-300 mb-1' }, 'â­ Avg Rating'),
              h('p', { className: 'text-2xl font-bold' }, stats.avgRating + '/10')
            ),
            h('div', { className: 'bg-green-600/20 p-4 rounded-xl border border-green-500/30' },
              h('h3', { className: 'text-xs font-semibold text-green-300 mb-1' }, 'ðŸ³ Homemade'),
              h('p', { className: 'text-2xl font-bold' }, stats.homemadePercent + '%')
            ),
            h('div', { className: 'bg-red-600/20 p-4 rounded-xl border border-red-500/30' },
              h('h3', { className: 'text-xs font-semibold text-red-300 mb-1' }, 'ðŸ† Top Cuisine'),
              h('p', { className: 'text-xl font-bold' }, stats.topCuisine)
            )
          ),
          
          stats && stats.topRated.length > 0 && h('div', { className: 'bg-gray-900/80 p-6 rounded-xl border border-gray-700 mb-6' },
            h('h3', { className: 'text-xl font-bold mb-4' }, 'â­ My Top Rated Dishes'),
            h('div', { className: 'space-y-2' },
              ...stats.topRated.map((dish, idx) =>
                h('div', { key: idx, className: 'bg-gray-800/50 p-3 rounded-lg flex justify-between items-center' },
                  h('span', { className: 'font-medium' }, dish.dishName),
                  h('span', { className: 'text-yellow-400 font-bold' }, 'â­ ' + dish.myRating + '/10')
                )
              )
            )
          ),
          
          h('button', {
            onClick: () => setShowAddForm(!showAddForm),
            className: 'fixed bottom-6 right-6 bg-gradient-to-r from-orange-600 to-yellow-600 p-4 rounded-full shadow-2xl text-3xl z-50'
          }, showAddForm ? 'âŒ' : 'âž•'),
          
          showAddForm && h('div', { className: 'bg-gray-900/95 p-6 rounded-xl border border-gray-700 mb-6' },
            h('h3', { className: 'text-2xl font-bold mb-4' }, 'ðŸ½ï¸ New Meal Entry'),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Date'),
              h('input', {
                type: 'date',
                value: newEntry.date,
                onChange: (e) => setNewEntry({...newEntry, date: e.target.value}),
                className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white'
              })
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Dish Name *'),
              h('input', {
                type: 'text',
                value: newEntry.dishName,
                onChange: (e) => setNewEntry({...newEntry, dishName: e.target.value}),
                placeholder: 'e.g., Pasta Carbonara',
                className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white'
              })
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Photo (Optional)'),
              h('div', { className: 'flex gap-2' },
                h('label', { className: 'bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg cursor-pointer flex items-center gap-2' },
                  h('span', null, 'ðŸ“· Upload Photo'),
                  h('input', {
                    type: 'file',
                    accept: 'image/*',
                    onChange: handlePhotoUpload,
                    className: 'hidden'
                  })
                ),
                newEntry.photo && h('span', { className: 'text-green-400 flex items-center gap-1' }, 'âœ… Photo added')
              )
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Meal Type *'),
              h('div', { className: 'grid grid-cols-3 sm:grid-cols-6 gap-2' },
                ...mealTypes.map(type =>
                  h('button', {
                    key: type.name,
                    type: 'button',
                    onClick: () => setNewEntry({...newEntry, mealType: type.name}),
                    className: `p-3 rounded-lg border-2 ${newEntry.mealType === type.name ? 'border-orange-500 bg-orange-600/30' : 'border-gray-700 bg-gray-800'}`
                  },
                    h('div', { className: 'text-2xl mb-1' }, type.emoji),
                    h('div', { className: 'text-xs' }, type.name)
                  )
                )
              )
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Cuisine'),
              h('div', { className: 'grid grid-cols-4 sm:grid-cols-8 gap-2' },
                ...cuisines.map(cuisine =>
                  h('button', {
                    key: cuisine.name,
                    type: 'button',
                    onClick: () => setNewEntry({...newEntry, cuisine: cuisine.name}),
                    className: `p-2 rounded-lg border-2 ${newEntry.cuisine === cuisine.name ? 'border-yellow-500 bg-yellow-600/30' : 'border-gray-700 bg-gray-800'}`
                  },
                    h('div', { className: 'text-2xl mb-1' }, cuisine.emoji),
                    h('div', { className: 'text-xs' }, cuisine.name)
                  )
                )
              )
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Where?'),
              h('div', { className: 'grid grid-cols-2 sm:grid-cols-4 gap-2' },
                ...cookingMethods.map(method =>
                  h('button', {
                    key: method.name,
                    type: 'button',
                    onClick: () => setNewEntry({...newEntry, cookingMethod: method.name}),
                    className: `p-3 rounded-lg border-2 ${newEntry.cookingMethod === method.name ? 'border-green-500 bg-green-600/30' : 'border-gray-700 bg-gray-800'}`
                  },
                    h('div', { className: 'text-2xl mb-1' }, method.emoji),
                    h('div', { className: 'text-xs' }, method.name)
                  )
                )
              )
            ),
            
            (newEntry.cookingMethod === 'Restaurant' || newEntry.cookingMethod === 'Takeout') && h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Restaurant Name'),
              h('input', {
                type: 'text',
                value: newEntry.restaurantName,
                onChange: (e) => setNewEntry({...newEntry, restaurantName: e.target.value}),
                placeholder: 'e.g., Olive Garden',
                className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white'
              })
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Allergens Present (tap any that apply)'),
              h('div', { className: 'flex flex-wrap gap-2' },
                ...allergens.map(allergen =>
                  h('button', {
                    key: allergen.id,
                    type: 'button',
                    onClick: () => {
                      const list = newEntry.allergens || [];
                      setNewEntry({
                        ...newEntry,
                        allergens: list.includes(allergen.id) 
                          ? list.filter(a => a !== allergen.id)
                          : [...list, allergen.id]
                      });
                    },
                    className: `py-2 px-3 rounded-full text-sm ${newEntry.allergens?.includes(allergen.id) ? 'bg-red-600 text-white' : 'bg-gray-800'}`
                  },
                    allergen.emoji + ' ' + allergen.name
                  )
                )
              )
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'My Rating: ' + newEntry.myRating + '/10'),
              h('div', { className: 'flex gap-1' },
                ...[1,2,3,4,5,6,7,8,9,10].map(num =>
                  h('button', {
                    key: num,
                    type: 'button',
                    onClick: () => setNewEntry({...newEntry, myRating: num}),
                    className: `flex-1 py-3 rounded-lg font-bold ${newEntry.myRating >= num ? 'bg-gradient-to-r from-orange-600 to-yellow-600 text-white' : 'bg-gray-800 text-gray-500'}`
                  }, num)
                )
              )
            ),
            
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Notes'),
              h('textarea', {
                value: newEntry.notes,
                onChange: (e) => setNewEntry({...newEntry, notes: e.target.value}),
                placeholder: 'How was it? Any special details...',
                rows: 3,
                className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white'
              })
            ),
            
            h('button', {
              onClick: addEntry,
              className: 'w-full bg-gradient-to-r from-green-600 to-emerald-600 py-3 rounded-lg font-semibold text-lg'
            }, 'âœ… Save Meal')
          ),
          
          h('div', { className: 'bg-gray-900/80 p-6 rounded-xl border border-gray-700' },
            h('h3', { className: 'text-xl font-bold mb-4' }, 'All Meals'),
            entries.length === 0 
              ? h('div', { className: 'text-center py-12' },
                  h('div', { className: 'text-6xl mb-4' }, 'ðŸ½ï¸'),
                  h('p', { className: 'text-gray-400' }, 'No meals tracked yet. Add your first meal!')
                )
              : h('div', { className: 'space-y-3' },
                  ...entries.map(entry =>
                    h('div', {
                      key: entry.id,
                      className: 'bg-gray-800/50 p-4 rounded-lg border border-gray-700'
                    },
                      h('div', { className: 'flex gap-4' },
                        entry.photo && h('img', {
                          src: entry.photo,
                          alt: entry.dishName,
                          className: 'w-20 h-20 object-cover rounded-lg'
                        }),
                        h('div', { className: 'flex-1' },
                          h('div', { className: 'flex justify-between items-start mb-2' },
                            h('div', null,
                              h('h4', { className: 'font-bold text-lg' }, entry.dishName),
                              h('p', { className: 'text-sm text-gray-400' },
                                entry.mealType + ' Â· ' + (entry.cuisine || 'No cuisine') + ' Â· ' + new Date(entry.date).toLocaleDateString()
                              ),
                              entry.cookingMethod && h('p', { className: 'text-xs text-gray-500' },
                                entry.cookingMethod + (entry.restaurantName ? ' - ' + entry.restaurantName : '')
                              )
                            ),
                            h('div', { className: 'flex items-center gap-3' },
                              h('span', { className: 'text-yellow-400 font-bold' }, 'â­ ' + entry.myRating),
                              entry.user === currentUser && h('button', {
                                onClick: () => deleteEntry(entry.id),
                                className: 'text-red-400 hover:text-red-300 text-sm'
                              }, 'Delete')
                            )
                          ),
                          entry.allergens && entry.allergens.length > 0 && h('div', { className: 'flex gap-1 mb-2' },
                            ...entry.allergens.map(a => {
                              const allergen = allergens.find(al => al.id === a);
                              return allergen ? h('span', {
                                key: a,
                                className: 'text-xs bg-red-600/30 px-2 py-1 rounded-full'
                              }, allergen.emoji + ' ' + allergen.name) : null;
                            })
                          ),
                          entry.notes && h('p', { className: 'text-sm text-gray-300 mt-2' }, entry.notes)
                        )
                      )
                    )
                  )
                )
          )
        )
      );
    }
    
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(h(App));
  </script>
</body>
</html>
