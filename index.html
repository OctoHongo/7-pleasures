<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Track life's pleasures - intimacy, food, rest, and more">
  <meta name="theme-color" content="#dc2626">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="7 Pleasures">
  <title>7 Pleasures</title>
  <link rel="manifest" href="./manifest.json">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ˜ˆ</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { margin: 0; padding: 0; overflow-x: hidden; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    ::-webkit-scrollbar { width: 0px; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
    const { useState, useEffect, createElement: h } = React;
    
    const positions = [
      { name: 'Missionary', emoji: 'ðŸ›ï¸' },
      { name: 'Cowgirl', emoji: 'ðŸ¤ ' },
      { name: 'Reverse Cowgirl', emoji: 'ðŸ”„' },
      { name: 'Doggy Style', emoji: 'ðŸ•' },
      { name: 'Spooning', emoji: 'ðŸ¥„' },
      { name: 'Standing', emoji: 'ðŸ§' },
      { name: '69', emoji: 'â™‹' },
      { name: 'Oral (Giving)', emoji: 'ðŸ‘…' },
      { name: 'Oral (Receiving)', emoji: 'ðŸ˜Œ' },
      { name: 'Legs Up', emoji: 'ðŸ¦µ' },
      { name: 'Butterfly', emoji: 'ðŸ¦‹' },
      { name: 'Lotus', emoji: 'ðŸª·' },
      { name: 'Side by Side', emoji: 'â†”ï¸' },
      { name: 'Against Wall', emoji: 'ðŸ§±' },
      { name: 'Seated', emoji: 'ðŸª‘' },
      { name: 'Other/Custom', emoji: 'âœ¨' }
    ];
    
    const durationOptions = ['5-10 min', '10-20 min', '20-30 min', '30-45 min', '45+ min'];
    const tagOptions = ['Romantic', 'Spontaneous', 'Planned', 'Morning', 'Evening', 'Night', 'Adventurous', 'Gentle', 'Passionate', 'Quickie'];
    
    function App() {
      const [currentUser, setCurrentUser] = useState('');
      const [showUserSetup, setShowUserSetup] = useState(true);
      const [entries, setEntries] = useState([]);
      const [showAddForm, setShowAddForm] = useState(false);
      const [showSyncMenu, setShowSyncMenu] = useState(false);
      const [newEntry, setNewEntry] = useState({
        date: new Date().toISOString().split('T')[0],
        position: '',
        myRating: 5,
        duration: '',
        notes: '',
        tags: []
      });
      
      useEffect(() => {
        const savedUser = localStorage.getItem('7pleasures_current_user');
        if (savedUser) {
          setCurrentUser(savedUser);
          setShowUserSetup(false);
          loadEntries();
        }
      }, []);
      
      const loadEntries = () => {
        const stored = localStorage.getItem('7pleasures_intimacy_all');
        if (stored) {
          setEntries(JSON.parse(stored));
        }
      };
      
      const saveEntries = (updatedEntries) => {
        localStorage.setItem('7pleasures_intimacy_all', JSON.stringify(updatedEntries));
        setEntries(updatedEntries);
      };
      
      const setupUser = (userName) => {
        if (!userName.trim()) return;
        localStorage.setItem('7pleasures_current_user', userName);
        setCurrentUser(userName);
        setShowUserSetup(false);
        loadEntries();
      };
      
      const addEntry = () => {
        if (!newEntry.position) {
          alert('Please select a position/activity');
          return;
        }
        const entry = {
          ...newEntry,
          user: currentUser,
          id: Date.now(),
          timestamp: new Date().toISOString()
        };
        const updated = [entry, ...entries];
        saveEntries(updated);
        setNewEntry({
          date: new Date().toISOString().split('T')[0],
          position: '',
          myRating: 5,
          duration: '',
          notes: '',
          tags: []
        });
        setShowAddForm(false);
      };
      
      const deleteEntry = (id) => {
        if (confirm('Delete this entry?')) {
          saveEntries(entries.filter(e => e.id !== id));
        }
      };
      
      const exportData = () => {
        const dataToExport = {
          user: currentUser,
          entries: entries,
          exportDate: new Date().toISOString()
        };
        const dataStr = JSON.stringify(dataToExport, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `7pleasures_${currentUser}_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        URL.revokeObjectURL(url);
      };
      
      const importData = (event) => {
        const file = event.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const imported = JSON.parse(e.target.result);
            if (imported.entries && Array.isArray(imported.entries)) {
              const existingIds = new Set(entries.map(e => e.id));
              const newEntries = imported.entries.filter(e => !existingIds.has(e.id));
              const merged = [...entries, ...newEntries].sort((a, b) => 
                new Date(b.timestamp) - new Date(a.timestamp)
              );
              saveEntries(merged);
              alert(`Imported ${newEntries.length} entries from ${imported.user}!`);
            }
          } catch (error) {
            alert('Error importing file');
          }
        };
        reader.readAsText(file);
      };
      
      const getStats = () => {
        if (entries.length === 0) return null;
        const thisYear = new Date().getFullYear();
        const yearEntries = entries.filter(e => new Date(e.date).getFullYear() === thisYear);
        const myEntries = yearEntries.filter(e => e.user === currentUser);
        const partnerEntries = yearEntries.filter(e => e.user !== currentUser);
        const partnerName = partnerEntries.length > 0 ? partnerEntries[0].user : 'Partner';
        const myAvg = myEntries.length > 0 ? (myEntries.reduce((sum, e) => sum + e.myRating, 0) / myEntries.length).toFixed(1) : 0;
        const partnerAvg = partnerEntries.length > 0 ? (partnerEntries.reduce((sum, e) => sum + e.myRating, 0) / partnerEntries.length).toFixed(1) : 0;
        const myFavorites = [...myEntries].sort((a, b) => b.myRating - a.myRating).slice(0, 3);
        const partnerFavorites = [...partnerEntries].sort((a, b) => b.myRating - a.myRating).slice(0, 3);
        return { total: yearEntries.length, myTotal: myEntries.length, partnerTotal: partnerEntries.length, myAvg, partnerAvg, partnerName, myFavorites, partnerFavorites };
      };
      
      const stats = getStats();
      
      if (showUserSetup) {
        return h('div', { className: 'min-h-screen bg-gradient-to-br from-purple-900 via-red-900 to-black text-white flex items-center justify-center p-4' },
          h('div', { className: 'bg-gray-900/90 p-8 rounded-2xl border border-gray-700 max-w-md w-full' },
            h('div', { className: 'text-center mb-6' },
              h('div', { className: 'text-6xl mb-4' }, 'ðŸ˜ˆ'),
              h('h1', { className: 'text-3xl font-bold mb-2' }, '7 Pleasures'),
              h('p', { className: 'text-gray-400 mb-4' }, 'Track what brings you joy')
            ),
            h('p', { className: 'text-sm text-gray-400 mb-4' }, "Who's tracking today?"),
            h('input', {
              type: 'text',
              placeholder: 'Enter your name',
              id: 'userName',
              onKeyPress: (e) => e.key === 'Enter' && setupUser(e.target.value),
              className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 mb-4 text-lg text-white',
              autoFocus: true
            }),
            h('button', {
              onClick: () => setupUser(document.getElementById('userName').value),
              className: 'w-full bg-gradient-to-r from-pink-600 to-red-600 hover:from-pink-700 hover:to-red-700 py-3 rounded-lg font-semibold'
            }, 'Start Tracking'),
            h('p', { className: 'text-xs text-gray-500 text-center mt-4' }, 'Data stored locally on your device')
          )
        );
      }
      
      return h('div', { className: 'min-h-screen bg-gradient-to-br from-purple-900 via-red-900 to-black text-white pb-20' },
        h('div', { className: 'max-w-6xl mx-auto p-4' },
          h('div', { className: 'flex justify-between items-center py-4 mb-4' },
            h('div', null,
              h('h1', { className: 'text-2xl font-bold' }, '7 Pleasures'),
              h('p', { className: 'text-xs text-gray-400' }, 'Track what brings you joy'),
              h('p', { className: 'text-sm text-purple-300' }, 'Tracking as: ' + currentUser)
            ),
            h('div', { className: 'flex gap-2' },
              h('button', {
                onClick: () => setShowSyncMenu(!showSyncMenu),
                className: 'bg-gray-800 hover:bg-gray-700 p-2 rounded-lg text-2xl',
                title: 'Sync Data'
              }, 'ðŸ“¤'),
              h('button', {
                onClick: () => { setShowUserSetup(true); setCurrentUser(''); },
                className: 'bg-gray-800 hover:bg-gray-700 p-2 rounded-lg text-2xl',
                title: 'Switch User'
              }, 'ðŸ‘¤')
            )
          ),
          
          showSyncMenu && h('div', { className: 'bg-gray-900/95 p-4 rounded-xl border border-gray-700 mb-4' },
            h('div', { className: 'flex justify-between items-center mb-4' },
              h('h3', { className: 'font-bold' }, 'Sync Data'),
              h('button', { onClick: () => setShowSyncMenu(false), className: 'text-2xl' }, 'âŒ')
            ),
            h('div', { className: 'grid grid-cols-2 gap-3' },
              h('button', {
                onClick: exportData,
                className: 'bg-gradient-to-r from-blue-600 to-cyan-600 py-3 rounded-lg font-semibold'
              }, 'â¬‡ï¸ Export'),
              h('label', { className: 'bg-gradient-to-r from-green-600 to-emerald-600 py-3 rounded-lg font-semibold text-center cursor-pointer' },
                'â¬†ï¸ Import',
                h('input', { type: 'file', accept: '.json', onChange: importData, className: 'hidden' })
              )
            ),
            h('p', { className: 'text-xs text-gray-400 mt-3' }, 'Export and share with your partner to merge entries')
          ),
          
          h('div', { className: 'mb-6' },
            h('div', { className: 'bg-gradient-to-r from-red-600 to-pink-600 p-4 rounded-xl' },
              h('h2', { className: 'text-xl font-bold' }, 'ðŸ’‹ Intimacy Tracker')
            )
          ),
          
          stats && h('div', { className: 'grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6' },
            h('div', { className: 'bg-gradient-to-br from-red-600/20 to-pink-600/20 p-4 rounded-xl border border-red-500/30' },
              h('h3', { className: 'text-xs font-semibold text-pink-300 mb-1' }, 'ðŸ“… Total This Year'),
              h('p', { className: 'text-2xl font-bold' }, stats.total)
            ),
            h('div', { className: 'bg-gradient-to-br from-purple-600/20 to-pink-600/20 p-4 rounded-xl border border-purple-500/30' },
              h('h3', { className: 'text-xs font-semibold text-purple-300 mb-1' }, 'ðŸ’œ My Entries'),
              h('p', { className: 'text-2xl font-bold' }, stats.myTotal),
              h('p', { className: 'text-xs text-purple-300' }, 'Avg: ' + stats.myAvg + '/10')
            ),
            h('div', { className: 'bg-gradient-to-br from-pink-600/20 to-red-600/20 p-4 rounded-xl border border-pink-500/30' },
              h('h3', { className: 'text-xs font-semibold text-pink-300 mb-1' }, 'ðŸ’– ' + stats.partnerName),
              h('p', { className: 'text-2xl font-bold' }, stats.partnerTotal),
              h('p', { className: 'text-xs text-pink-300' }, 'Avg: ' + stats.partnerAvg + '/10')
            ),
            h('div', { className: 'bg-gradient-to-br from-red-600/20 to-orange-600/20 p-4 rounded-xl border border-red-500/30' },
              h('h3', { className: 'text-xs font-semibold text-orange-300 mb-1' }, 'ðŸ“ˆ Monthly Avg'),
              h('p', { className: 'text-2xl font-bold' }, (stats.total / (new Date().getMonth() + 1)).toFixed(1))
            )
          ),
          
          stats && stats.partnerTotal > 0 && h('div', { className: 'bg-gray-900/80 p-6 rounded-xl border border-gray-700 mb-6' },
            h('h3', { className: 'text-xl font-bold mb-4' }, 'ðŸ“Š Comparison: What We Both Enjoy'),
            h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-6' },
              h('div', null,
                h('h4', { className: 'text-sm font-semibold text-purple-300 mb-3' }, 'My Top Rated'),
                h('div', { className: 'space-y-2' },
                  ...stats.myFavorites.map((fav, idx) =>
                    h('div', { key: idx, className: 'bg-gray-800/50 p-3 rounded-lg' },
                      h('div', { className: 'flex justify-between items-center' },
                        h('span', { className: 'font-medium' }, fav.position),
                        h('span', { className: 'text-purple-400 font-bold' }, 'ðŸ’œ ' + fav.myRating + '/10')
                      )
                    )
                  )
                )
              ),
              h('div', null,
                h('h4', { className: 'text-sm font-semibold text-pink-300 mb-3' }, stats.partnerName + "'s Top Rated"),
                h('div', { className: 'space-y-2' },
                  ...stats.partnerFavorites.map((fav, idx) =>
                    h('div', { key: idx, className: 'bg-gray-800/50 p-3 rounded-lg' },
                      h('div', { className: 'flex justify-between items-center' },
                        h('span', { className: 'font-medium' }, fav.position),
                        h('span', { className: 'text-pink-400 font-bold' }, 'ðŸ’– ' + fav.myRating + '/10')
                      )
                    )
                  )
                )
              )
            )
          ),
          
          h('button', {
            onClick: () => setShowAddForm(!showAddForm),
            className: 'fixed bottom-6 right-6 bg-gradient-to-r from-pink-600 to-red-600 p-4 rounded-full shadow-2xl text-3xl z-50'
          }, showAddForm ? 'âŒ' : 'âž•'),
          
          showAddForm && h('div', { className: 'bg-gray-900/95 p-6 rounded-xl border border-gray-700 mb-6' },
            h('h3', { className: 'text-2xl font-bold mb-4' }, 'New Entry'),
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Date'),
              h('input', {
                type: 'date',
                value: newEntry.date,
                onChange: (e) => setNewEntry({...newEntry, date: e.target.value}),
                className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white'
              })
            ),
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Position/Activity *'),
              h('div', { className: 'grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2' },
                ...positions.map(pos =>
                  h('button', {
                    key: pos.name,
                    type: 'button',
                    onClick: () => setNewEntry({...newEntry, position: pos.name}),
                    className: `p-3 rounded-lg border-2 transition-all ${newEntry.position === pos.name ? 'border-pink-500 bg-pink-600/30 scale-105' : 'border-gray-700 bg-gray-800'}`
                  },
                    h('div', { className: 'text-3xl mb-1' }, pos.emoji),
                    h('div', { className: 'text-xs font-medium' }, pos.name)
                  )
                )
              )
            ),
            newEntry.position === 'Other/Custom' && h('div', { className: 'mb-4' },
              h('input', {
                type: 'text',
                placeholder: 'Enter custom position...',
                onChange: (e) => setNewEntry({...newEntry, position: e.target.value || 'Other/Custom'}),
                className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white'
              })
            ),
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'My Rating: ' + newEntry.myRating + '/10'),
              h('div', { className: 'flex gap-1' },
                ...[1,2,3,4,5,6,7,8,9,10].map(num =>
                  h('button', {
                    key: num,
                    type: 'button',
                    onClick: () => setNewEntry({...newEntry, myRating: num}),
                    className: `flex-1 py-3 rounded-lg font-bold ${newEntry.myRating >= num ? 'bg-gradient-to-r from-pink-600 to-red-600 text-white' : 'bg-gray-800 text-gray-500'}`
                  }, num)
                )
              )
            ),
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Duration'),
              h('div', { className: 'grid grid-cols-3 sm:grid-cols-5 gap-2' },
                ...durationOptions.map(dur =>
                  h('button', {
                    key: dur,
                    type: 'button',
                    onClick: () => setNewEntry({...newEntry, duration: dur}),
                    className: `py-2 px-3 rounded-lg text-sm font-medium ${newEntry.duration === dur ? 'bg-purple-600 text-white' : 'bg-gray-800 text-gray-300'}`
                  }, dur)
                )
              )
            ),
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Tags'),
              h('div', { className: 'flex flex-wrap gap-2' },
                ...tagOptions.map(tag =>
                  h('button', {
                    key: tag,
                    type: 'button',
                    onClick: () => {
                      const tags = newEntry.tags || [];
                      setNewEntry({...newEntry, tags: tags.includes(tag) ? tags.filter(t => t !== tag) : [...tags, tag]});
                    },
                    className: `py-2 px-4 rounded-full text-sm font-medium ${newEntry.tags?.includes(tag) ? 'bg-pink-600 text-white' : 'bg-gray-800 text-gray-300'}`
                  }, (newEntry.tags?.includes(tag) ? 'âœ“ ' : '') + tag)
                )
              )
            ),
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-medium mb-2' }, 'Notes'),
              h('textarea', {
                value: newEntry.notes,
                onChange: (e) => setNewEntry({...newEntry, notes: e.target.value}),
                placeholder: 'Any details...',
                rows: 3,
                className: 'w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white'
              })
            ),
            h('button', {
              onClick: addEntry,
              className: 'w-full bg-gradient-to-r from-green-600 to-emerald-600 py-3 rounded-lg font-semibold'
            }, 'âœ… Save Entry')
          ),
          
          h('div', { className: 'bg-gray-900/80 p-6 rounded-xl border border-gray-700' },
            h('h3', { className: 'text-xl font-bold mb-4' }, 'All Entries'),
            entries.length === 0 ? 
              h('div', { className: 'text-center py-12' },
                h('div', { className: 'text-6xl mb-4' }, 'ðŸ’‹'),
                h('p', { className: 'text-gray-400' }, 'No entries yet. Start tracking!')
              ) :
              h('div', { className: 'space-y-3' },
                ...entries.map(entry =>
                  h('div', {
                    key: entry.id,
                    className: `p-4 rounded-lg border-2 ${entry.user === currentUser ? 'bg-purple-900/20 border-purple-500/30' : 'bg-pink-900/20 border-pink-500/30'}`
                  },
                    h('div', { className: 'flex justify-between items-start mb-2' },
                      h('div', null,
                        h('h4', { className: 'font-bold text-lg' }, entry.position),
                        h('p', { className: 'text-sm text-gray-400' }, new Date(entry.date).toLocaleDateString() + ' Â· ' + entry.user)
                      ),
                      h('div', { className: 'flex items-center gap-3' },
                        h('span', { className: 'font-bold' }, 'ðŸ’– ' + entry.myRating + '/10'),
                        entry.user === currentUser && h('button', {
                          onClick: () => deleteEntry(entry.id),
                          className: 'text-red-400 text-sm'
                        }, 'Delete')
                      )
                    ),
                    entry.duration && h('p', { className: 'text-sm text-gray-400 mb-1' }, 'â±ï¸ ' + entry.duration),
                    entry.notes && h('p', { className: 'text-sm text-gray-300 mt-2' }, entry.notes),
                    entry.tags && entry.tags.length > 0 && h('div', { className: 'flex gap-2 mt-2 flex-wrap' },
                      ...entry.tags.map((tag, idx) =>
                        h('span', { key: idx, className: 'text-xs bg-pink-600/30 px-2 py-1 rounded-full' }, tag)
                      )
                    )
                  )
                )
              )
          )
        )
      );
    }
    
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(h(App));
  </script>
  
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').catch(() => {});
      });
    }
  </script>
</body>
</html>
